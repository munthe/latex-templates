% lualatex quizogbyt.tex [database.csv]
% Hvor csv filen skal have to kolonner [Dyr] og [Billede](som er den relative sti til et billede)
\documentclass[a4paper,oneside]{memoir}
\usepackage{ifdraft}

\settypeblocksize{276mm}{200mm}{*} % Højde*bredde på side
\setlrmargins{*}{*}{1}
\setulmargins{*}{*}{0.5}
\setheaderspaces{*}{3mm}{*}
\checkandfixthelayout
\pagestyle{plain}
\makeatletter
\makeoddhead{plain}{\@title, sæt \arabic{KortSet}}{\today}{\thepage}
\makeevenhead{plain}{\thepage}{\today}{\@title, sæt \arabic{KortSet}}
\newcommand{\Titel}{\@title}
\setlength{\parindent}{0mm}
\makeatother
\ifdraft{\usepackage{showframe}}{}

\usepackage{datatool}
\DTLsetseparator{,}
\DTLloaddb{kort}{
\directlua{ % Tager første argument som database navn, eller standard til fakta.csv
	if arg[2]
	then tex.print(arg[2])
	else tex.print("\string dyr.csv")
end}}

\usepackage{graphicx}
\graphicspath{{./Billeder/}}
\usepackage{pgffor}
\usepackage{tcolorbox}
\tcbuselibrary{skins,hooks}
\input{tangocolors.tex}
\newcounter{KortSet}
\newcounter{KortNummer}[KortSet]

\title{Dyrekort}
\begin{document}

\def\farver{{Aluminium},{Butter},{Chameleon},{Orange},{Chocolate},{SkyBlue},{Plum},{Slate},{ScarletRed}}

% Ark med farvede overskrifter til hvert sæt kort.
\thispagestyle{empty}
\setlength{\arrayrulewidth}{1mm}
\foreach \farve in \farver {% 
{\color{\farve} \HUGE
\hfill \Titel \hfill {\small printet: \today}
% \hline \\
\vfill
}
}
\cleardoublepage

\foreach \farve in \farver {% Loop der laver flere sæt kort, med forskellig farve
\stepcounter{KortSet}

%\hspace{1mm} % negativspace før første kort, hvorfor er dette nødvendigt? 
\tcbset{enhanced,width=(\linewidth)/3,nobeforeafter,arc=4mm,
colframe=\farve,colback=white,
left=1mm,right=1mm,top=1mm,bottom=1mm,middle=0mm,equal height group=kort,
valign upper=center, valign lower=bottom, split=1,
enlarge top by=1mm, enlarge bottom by=1mm,grow to left by=-1mm, grow to right by=-1mm}
\ifdraft{\tcbset{show bounding box}}{}
\DTLforeach*{kort}
{\tekst=Dyr, \billede=Billede}
{% Kort
\stepcounter{KortNummer}%
\begin{tcolorbox}
%	\vspace{1mm}
	\Huge \centering \tekst  \\
	\tcblower
	\centering
 	\includegraphics[height=42mm]{\billede}
%	\vfill \hfill
%	{\small \arabic{KortNummer}}
\end{tcolorbox}%
\allowbreak%
}% Kort slut

\cleardoublepage
} % Slut kort sæt loop
\end{document}
